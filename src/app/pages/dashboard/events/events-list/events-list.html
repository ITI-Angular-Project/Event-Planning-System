<app-table
  [title]="'Events'"
  [subtitle]="'Manage and track all your events'"
  [columns]="eventsColumns"
  [data]="eventsData()"
  [createButtonText]="'Create Event'"
  [showFilters]="true"
  [showPagination]="true"
  [filters]="eventsFilters"
  [pageSize]="10"
  [currentPage]="1"
  [totalItems]="eventsData.length"
  (create)="onCreateEvent()"
  (view)="onViewEvent($event)"
  (edit)="onEditEvent($event)"
  (delete)="onDeleteEvent($event)"
  (search)="onSearchEvents($event)"
  (filterChange)="onFilterEvents($event)"
  (pageChange)="onPageChange($event)"
>
</app-table>
<!-- confirm delete model -->
<app-modal
  [show]="showDeleteModal"
  title="Confirm Deletion"
  [message]="'Are you sure you want to delete ' + selectedEvent?.name + '?'"
  confirmText="Delete"
  cancelText="Cancel"
  (confirm)="confirmDelete()"
  (cancel)="cancelDelete()"
></app-modal>
<!-- create event modal -->
<app-modal [show]="showCreateModal" title="Create New Event" (cancel)="cancelCreate()">
  <form class="space-y-4" (ngSubmit)="saveNewEvent()">
    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Event Name</label>
      <input
        type="text"
        [(ngModel)]="newEvent.name"
        name="name"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Category</label>
      <select
        [(ngModel)]="newEvent.category"
        name="category"
        required
        class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border px-3 py-2 text-sm"
      >
        <option value="" disabled>Select category</option>
        <option *ngFor="let c of eventsFilters[1].options" [value]="c.value">
          {{ c.label }}
        </option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Description</label>
      <input
        type="text"
        [(ngModel)]="newEvent.descrition"
        name="descrition"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Location</label>
      <input
        type="text"
        [(ngModel)]="newEvent.location"
        name="location"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      />
    </div>

    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Start Date</label>
        <input
          type="date"
          [(ngModel)]="newEvent.startDate"
          name="startDate"
          class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">End Date</label>
        <input
          type="date"
          [(ngModel)]="newEvent.endDate"
          name="endDate"
          class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
        />
      </div>
    </div>

    <div class="flex justify-end gap-2 mt-5">
      <button
        type="button"
        (click)="cancelCreate()"
        class="px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600"
      >
        Cancel
      </button>

      <button
        type="submit"
        class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary/90"
      >
        Save Event
      </button>
    </div>
  </form>
</app-modal>
<!-- edit event modal -->
@if (editingEvent) {
<app-modal [show]="showEditModal" title="Edit Event" (cancel)="cancelEdit()">
  <form class="space-y-4" (ngSubmit)="saveEditedEvent()">
    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Event Name</label>
      <input
        type="text"
        [(ngModel)]="editingEvent.name"
        name="editName"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      />
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Category</label>
      <select
        [(ngModel)]="editingEvent.category"
        name="editCategory"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      >
        <option value="" disabled>Select category</option>
        <option *ngFor="let c of eventsFilters[1].options" [value]="c.value">{{ c.label }}</option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Status</label>
      <select
        [(ngModel)]="editingEvent.status"
        name="editStatus"
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      >
        <option *ngFor="let s of eventsFilters[0].options" [value]="s.value">{{ s.label }}</option>
      </select>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Location</label>
      <input
        type="text"
        [(ngModel)]="editingEvent.location"
        name="editLocation"
        required
        class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
      />
    </div>

    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">Start Date</label>
        <input
          type="date"
          [(ngModel)]="editingEvent.startDate"
          name="editStartDate"
          class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200">End Date</label>
        <input
          type="date"
          [(ngModel)]="editingEvent.endDate"
          name="editEndDate"
          class="mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm"
        />
      </div>
    </div>

    <div class="flex justify-end gap-2 mt-5">
      <button
        type="button"
        (click)="cancelEdit()"
        class="px-4 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600"
      >
        Cancel
      </button>

      <button
        type="submit"
        class="px-4 py-2 text-sm bg-primary text-white rounded-md hover:bg-primary/90"
      >
        Save Changes
      </button>
    </div>
  </form>
</app-modal>
}
